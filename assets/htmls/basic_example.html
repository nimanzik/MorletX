<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>basic_example.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>basic example</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/index-OC46250R.js"></script>
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.15.5/dist/assets/index-CknhX2Vy.css">

<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "basic_example.py",
            "mode": "read",
            "version": "0.15.5",
            "serverToken": "static",
            "config": {"ai": {"models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false}, "display": {"cell_output": "above", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": false, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": true}}, "package_management": {"manager": "pip"}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo", "code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "from dataclasses import dataclass\nfrom pathlib import Path\n\nimport matplotlib.pyplot as plt\nimport numpy as np\n\nfrom morletx import MorletFilterBank\n\nplt.style.use(\"seaborn-v0_8\")", "code_hash": "1e0d372a551a8183a6e6bcbde5c39170", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "mo.md(r\"\"\"## Load example signal data\"\"\")", "code_hash": "a45cee356eed03fc6c8863b66fb954c6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "@dataclass\nclass Signal:\n    times: np.ndarray\n    values: np.ndarray\n    fs: float\n\n    @property\n    def duration(self):\n        return self.times.max() - self.times.min()\n\n    @property\n    def num_samples(self):\n        return len(self.values)\n\n    def __repr__(self):\n        return f\"Signal duration: {self.duration} s | num. of samples: {self.num_samples} | sampling frequency: {self.fs}\"", "code_hash": "c10ea75c90307013d85c311697b7576f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "npz_file = Path(__file__).parents[1] / \"data\" / \"fin_whale_song.npz\"\nnpz_data = np.load(npz_file)\n\nsignal = Signal(\n    times=npz_data[\"times\"], values=npz_data[\"values\"], fs=npz_data[\"fs\"]\n)\n\nprint(signal)", "code_hash": "ae0bb11539d16d64844db973696d8a8f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "mo.md(r\"\"\"## Fin-Whale song recording signal\"\"\")", "code_hash": "2ea2ce8a6fda086d1416c884f5cfe26a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "fig_sig, ax_sig = plt.subplots(figsize=(10, 6))\nax_sig.plot(signal.times, signal.values)\nax_sig.set(\n    xlabel=\"Time [s]\",\n    ylabel=\"Acoustic Amplitude\",\n    title=\"Fin-Whale song recording | Bandpass filtered 12\u201330 Hz\",\n)\nmo.mpl.interactive(fig_sig)", "code_hash": "f9d4d525d2bc0c3d2ef43385f3991edd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "mo.md(r\"\"\"## Apply the CWT and compute scalogram\"\"\")", "code_hash": "5566e7471eb15c0b1ff4692551824c98", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "filt_bank = MorletFilterBank(\n    n_octaves=2,\n    n_intervals=10,\n    shape_ratio=5.0,\n    duration=1.0,\n    sampling_freq=signal.fs,\n    array_engine=\"numpy\",\n)\n\nmode = \"magnitude\"\nscalogram = filt_bank.transform(signal.values, mode=mode, detach_from_device=True)\n\nprint(f\"Scalogram array shape: {scalogram.shape}\")", "code_hash": "960e8f66b6c727344974e583cf05ecba", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "mo.md(r\"\"\"## Display the scalogram\"\"\")", "code_hash": "00b6de153208c3654d086b54a01d40b0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "fig_sgram, ax_sgram = plt.subplots(figsize=(10, 6))\nfilt_bank.plot_scalogram(\n    ax=ax_sgram,\n    scalogram=scalogram,\n    mode=mode,\n)\n\nax_sgram.grid(False)\nmo.mpl.interactive(fig_sgram)", "code_hash": "b336cee97ab56dc15bf8272e26da9569", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "mo.md(r\"\"\"## Display the frequency responses of the filterbank\"\"\")", "code_hash": "5d6d19056760bf823965ddbebf2f9a90", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "fig_resps, ax_resps = plt.subplots(figsize=(10, 6))\nfilt_bank.plot_responses(ax_resps, n_fft=512)\nmo.mpl.interactive(fig_resps)", "code_hash": "6c32542af3375ac4b8a1b00421a1c4c3", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}], "metadata": {"marimo_version": "0.15.5"}, "version": "1"},
            "session": {"cells": [{"code_hash": "1d0db38904205bec4d6f6f6a1f6cec3e", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "1e0d372a551a8183a6e6bcbde5c39170", "console": [], "id": "MJUe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "a45cee356eed03fc6c8863b66fb954c6", "console": [], "id": "vblA", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"load-example-signal-data\">Load example signal data</h2></span>"}, "type": "data"}]}, {"code_hash": "c10ea75c90307013d85c311697b7576f", "console": [], "id": "bkHC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ae0bb11539d16d64844db973696d8a8f", "console": [{"name": "stdout", "text": "Signal duration: 30.0 s | num. of samples: 3001 | sampling frequency: 100.0\n", "type": "stream"}], "id": "lEQa", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "2ea2ce8a6fda086d1416c884f5cfe26a", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"fin-whale-song-recording-signal\">Fin-Whale song recording signal</h2></span>"}, "type": "data"}]}, {"code_hash": "f9d4d525d2bc0c3d2ef43385f3991edd", "console": [], "id": "Xref", "outputs": [{"data": {"text/html": "<iframe srcdoc='&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n  &lt;head&gt;\n    &lt;base href=&#x27;http://localhost:2818/mpl/10001/&#x27; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/page.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/boilerplate.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/fbm.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/mpl.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/custom.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;script src=&quot;http://localhost:2818/mpl/10001/mpl.js&quot;&gt;&lt;/script&gt;\n\n    &lt;script&gt;\n      function ondownload(figure, format) {\n        window.open(&#x27;download.&#x27; + format + &#x27;?figure=&#x27; + figure.id, &#x27;_blank&#x27;);\n      };\n\n      function ready(fn) {\n        if (document.readyState != &quot;loading&quot;) {\n          fn();\n        } else {\n          document.addEventListener(&quot;DOMContentLoaded&quot;, fn);\n        }\n      }\n\n      ready(\n        function() {\n          var websocket_type = mpl.get_websocket_type();\n          var websocket = new websocket_type(&quot;ws://localhost:2818/mpl/10001/ws?figure=123187529929008&quot;);\n\n          // mpl.figure creates a new figure on the webpage.\n          var fig = new mpl.figure(\n              // A unique numeric identifier for the figure\n              123187529929008,\n              // A websocket object\n              websocket,\n              // A function called when a file type is selected for download\n              ondownload,\n              // The HTML element in which to place the figure\n              document.getElementById(&quot;figure&quot;));\n        }\n      );\n    &lt;/script&gt;\n\n    &lt;title&gt;marimo&lt;/title&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n    &lt;div id=&quot;figure&quot;&gt;&lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;' width='100%' height='550px' onload='__resizeIframe(this)' frameborder='0'></iframe>"}, "type": "data"}]}, {"code_hash": "5566e7471eb15c0b1ff4692551824c98", "console": [], "id": "SFPL", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"apply-the-cwt-and-compute-scalogram\">Apply the CWT and compute scalogram</h2></span>"}, "type": "data"}]}, {"code_hash": "960e8f66b6c727344974e583cf05ecba", "console": [{"name": "stdout", "text": "Scalogram array shape: (19, 3001)\n", "type": "stream"}], "id": "BYtC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "00b6de153208c3654d086b54a01d40b0", "console": [], "id": "RGSE", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"display-the-scalogram\">Display the scalogram</h2></span>"}, "type": "data"}]}, {"code_hash": "b336cee97ab56dc15bf8272e26da9569", "console": [], "id": "Kclp", "outputs": [{"data": {"text/html": "<iframe srcdoc='&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n  &lt;head&gt;\n    &lt;base href=&#x27;http://localhost:2818/mpl/10001/&#x27; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/page.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/boilerplate.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/fbm.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/mpl.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/custom.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;script src=&quot;http://localhost:2818/mpl/10001/mpl.js&quot;&gt;&lt;/script&gt;\n\n    &lt;script&gt;\n      function ondownload(figure, format) {\n        window.open(&#x27;download.&#x27; + format + &#x27;?figure=&#x27; + figure.id, &#x27;_blank&#x27;);\n      };\n\n      function ready(fn) {\n        if (document.readyState != &quot;loading&quot;) {\n          fn();\n        } else {\n          document.addEventListener(&quot;DOMContentLoaded&quot;, fn);\n        }\n      }\n\n      ready(\n        function() {\n          var websocket_type = mpl.get_websocket_type();\n          var websocket = new websocket_type(&quot;ws://localhost:2818/mpl/10001/ws?figure=123187525769056&quot;);\n\n          // mpl.figure creates a new figure on the webpage.\n          var fig = new mpl.figure(\n              // A unique numeric identifier for the figure\n              123187525769056,\n              // A websocket object\n              websocket,\n              // A function called when a file type is selected for download\n              ondownload,\n              // The HTML element in which to place the figure\n              document.getElementById(&quot;figure&quot;));\n        }\n      );\n    &lt;/script&gt;\n\n    &lt;title&gt;marimo&lt;/title&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n    &lt;div id=&quot;figure&quot;&gt;&lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;' width='100%' height='550px' onload='__resizeIframe(this)' frameborder='0'></iframe>"}, "type": "data"}]}, {"code_hash": "5d6d19056760bf823965ddbebf2f9a90", "console": [], "id": "emfo", "outputs": [{"data": {"text/html": "<span class=\"markdown prose dark:prose-invert\"><h2 id=\"display-the-frequency-responses-of-the-filterbank\">Display the frequency responses of the filterbank</h2></span>"}, "type": "data"}]}, {"code_hash": "6c32542af3375ac4b8a1b00421a1c4c3", "console": [], "id": "Hstk", "outputs": [{"data": {"text/html": "<iframe srcdoc='&lt;!DOCTYPE html&gt;\n&lt;html lang=&quot;en&quot;&gt;\n  &lt;head&gt;\n    &lt;base href=&#x27;http://localhost:2818/mpl/10001/&#x27; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/page.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/boilerplate.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/fbm.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/_static/css/mpl.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;http://localhost:2818/mpl/10001/custom.css&quot; type=&quot;text/css&quot; /&gt;\n    &lt;script src=&quot;http://localhost:2818/mpl/10001/mpl.js&quot;&gt;&lt;/script&gt;\n\n    &lt;script&gt;\n      function ondownload(figure, format) {\n        window.open(&#x27;download.&#x27; + format + &#x27;?figure=&#x27; + figure.id, &#x27;_blank&#x27;);\n      };\n\n      function ready(fn) {\n        if (document.readyState != &quot;loading&quot;) {\n          fn();\n        } else {\n          document.addEventListener(&quot;DOMContentLoaded&quot;, fn);\n        }\n      }\n\n      ready(\n        function() {\n          var websocket_type = mpl.get_websocket_type();\n          var websocket = new websocket_type(&quot;ws://localhost:2818/mpl/10001/ws?figure=123187525086208&quot;);\n\n          // mpl.figure creates a new figure on the webpage.\n          var fig = new mpl.figure(\n              // A unique numeric identifier for the figure\n              123187525086208,\n              // A websocket object\n              websocket,\n              // A function called when a file type is selected for download\n              ondownload,\n              // The HTML element in which to place the figure\n              document.getElementById(&quot;figure&quot;));\n        }\n      );\n    &lt;/script&gt;\n\n    &lt;title&gt;marimo&lt;/title&gt;\n  &lt;/head&gt;\n\n  &lt;body&gt;\n    &lt;div id=&quot;figure&quot;&gt;&lt;/div&gt;\n  &lt;/body&gt;\n&lt;/html&gt;' width='100%' height='550px' onload='__resizeIframe(this)' frameborder='0'></iframe>"}, "type": "data"}]}], "metadata": {"marimo_version": "0.15.5"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>

<marimo-code hidden="">
    import%20marimo%0A%0A__generated_with%20%3D%20%220.15.5%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20from%20dataclasses%20import%20dataclass%0A%20%20%20%20from%20pathlib%20import%20Path%0A%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20import%20numpy%20as%20np%0A%0A%20%20%20%20from%20morletx%20import%20MorletFilterBank%0A%0A%20%20%20%20plt.style.use(%22seaborn-v0_8%22)%0A%20%20%20%20return%20MorletFilterBank%2C%20Path%2C%20dataclass%2C%20np%2C%20plt%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%20Load%20example%20signal%20data%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(dataclass%2C%20np)%3A%0A%20%20%20%20%40dataclass%0A%20%20%20%20class%20Signal%3A%0A%20%20%20%20%20%20%20%20times%3A%20np.ndarray%0A%20%20%20%20%20%20%20%20values%3A%20np.ndarray%0A%20%20%20%20%20%20%20%20fs%3A%20float%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20duration(self)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20self.times.max()%20-%20self.times.min()%0A%0A%20%20%20%20%20%20%20%20%40property%0A%20%20%20%20%20%20%20%20def%20num_samples(self)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20len(self.values)%0A%0A%20%20%20%20%20%20%20%20def%20__repr__(self)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20f%22Signal%20duration%3A%20%7Bself.duration%7D%20s%20%7C%20num.%20of%20samples%3A%20%7Bself.num_samples%7D%20%7C%20sampling%20frequency%3A%20%7Bself.fs%7D%22%0A%20%20%20%20return%20(Signal%2C)%0A%0A%0A%40app.cell%0Adef%20_(Path%2C%20Signal%2C%20np)%3A%0A%20%20%20%20npz_file%20%3D%20Path(__file__).parents%5B1%5D%20%2F%20%22data%22%20%2F%20%22fin_whale_song.npz%22%0A%20%20%20%20npz_data%20%3D%20np.load(npz_file)%0A%0A%20%20%20%20signal%20%3D%20Signal(%0A%20%20%20%20%20%20%20%20times%3Dnpz_data%5B%22times%22%5D%2C%20values%3Dnpz_data%5B%22values%22%5D%2C%20fs%3Dnpz_data%5B%22fs%22%5D%0A%20%20%20%20)%0A%0A%20%20%20%20print(signal)%0A%20%20%20%20return%20(signal%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%20Fin-Whale%20song%20recording%20signal%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo%2C%20plt%2C%20signal)%3A%0A%20%20%20%20fig_sig%2C%20ax_sig%20%3D%20plt.subplots(figsize%3D(10%2C%206))%0A%20%20%20%20ax_sig.plot(signal.times%2C%20signal.values)%0A%20%20%20%20ax_sig.set(%0A%20%20%20%20%20%20%20%20xlabel%3D%22Time%20%5Bs%5D%22%2C%0A%20%20%20%20%20%20%20%20ylabel%3D%22Acoustic%20Amplitude%22%2C%0A%20%20%20%20%20%20%20%20title%3D%22Fin-Whale%20song%20recording%20%7C%20Bandpass%20filtered%2012%E2%80%9330%20Hz%22%2C%0A%20%20%20%20)%0A%20%20%20%20mo.mpl.interactive(fig_sig)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%20Apply%20the%20CWT%20and%20compute%20scalogram%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(MorletFilterBank%2C%20signal)%3A%0A%20%20%20%20filt_bank%20%3D%20MorletFilterBank(%0A%20%20%20%20%20%20%20%20n_octaves%3D2%2C%0A%20%20%20%20%20%20%20%20n_intervals%3D10%2C%0A%20%20%20%20%20%20%20%20shape_ratio%3D5.0%2C%0A%20%20%20%20%20%20%20%20duration%3D1.0%2C%0A%20%20%20%20%20%20%20%20sampling_freq%3Dsignal.fs%2C%0A%20%20%20%20%20%20%20%20array_engine%3D%22numpy%22%2C%0A%20%20%20%20)%0A%0A%20%20%20%20mode%20%3D%20%22magnitude%22%0A%20%20%20%20scalogram%20%3D%20filt_bank.transform(signal.values%2C%20mode%3Dmode%2C%20detach_from_device%3DTrue)%0A%0A%20%20%20%20print(f%22Scalogram%20array%20shape%3A%20%7Bscalogram.shape%7D%22)%0A%20%20%20%20return%20filt_bank%2C%20mode%2C%20scalogram%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%20Display%20the%20scalogram%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(filt_bank%2C%20mo%2C%20mode%2C%20plt%2C%20scalogram)%3A%0A%20%20%20%20fig_sgram%2C%20ax_sgram%20%3D%20plt.subplots(figsize%3D(10%2C%206))%0A%20%20%20%20filt_bank.plot_scalogram(%0A%20%20%20%20%20%20%20%20ax%3Dax_sgram%2C%0A%20%20%20%20%20%20%20%20scalogram%3Dscalogram%2C%0A%20%20%20%20%20%20%20%20mode%3Dmode%2C%0A%20%20%20%20)%0A%0A%20%20%20%20ax_sgram.grid(False)%0A%20%20%20%20mo.mpl.interactive(fig_sgram)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%23%20Display%20the%20frequency%20responses%20of%20the%20filterbank%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(filt_bank%2C%20mo%2C%20plt)%3A%0A%20%20%20%20fig_resps%2C%20ax_resps%20%3D%20plt.subplots(figsize%3D(10%2C%206))%0A%20%20%20%20filt_bank.plot_responses(ax_resps%2C%20n_fft%3D512)%0A%20%20%20%20mo.mpl.interactive(fig_resps)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">e87d750fd97991edd91a33c74c4e0105c312c851d0300ff53b3bfdbd81c9bfff</marimo-code-hash>
</body>
</html>
